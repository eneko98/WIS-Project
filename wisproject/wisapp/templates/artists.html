<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Let's get shit done</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <h1 id="auth"> </h1>
    <h1> Let's get shit doneeeeee</h1>
    <h1> Artist Name: </h1>
    <h2 id="Artist">  </h2>
    <h1> Genres: </h1>
    <h2 id="Genre"> </h2>
    <h1> Followers: </h1>
    <h2 id="Follow"> </h2>
    <div id="image"> </div>

    <script>
        //Post
        // curl -X POST "https://accounts.spotify.com/api/token" -H "Content-Type: application/x-www-form-urlencoded" -d "grant_type=client_credentials&client_id=52c45b6398544dce8ff8d3b9eb41d71f&client_secret=82c3bc810f8145d4b9b3c892607d8526"
        // Invoke-RestMethod -Uri "https://accounts.spotify.com/api/token" -Method POST -Headers @{"Content-Type"="application/x-www-form-urlencoded"} -Body "grant_type=client_credentials&client_id=52c45b6398544dce8ff8d3b9eb41d71f&client_secret=82c3bc810f8145d4b9b3c892607d8526"
        //https://open.spotify.com/artist/4CiDIYMPPxX4ZOJ2R1ZL9e?si=YVlwIKdAQ5iSM6Y_-tpomw
        const url = "https://accounts.spotify.com/api/token";
        const headers = {
            "Content-Type": "application/x-www-form-urlencoded"
        };
        const body = "grant_type=client_credentials&client_id=52c45b6398544dce8ff8d3b9eb41d71f&client_secret=82c3bc810f8145d4b9b3c892607d8526";
        let auth_code = ""
        let data1={};
        fetch(url, {
            method: 'POST',
            headers: headers,
            body: body
        })
        .then(response => response.json())
        .then(data => {
            data1 = data;
            auth_code = data['access_token'];
            get_artist_info()
        })
        .catch(error => console.error('Error:', error));

        
        function get_artist_info(){
            fetch("https://api.spotify.com/v1/artists/1Xyo4u8uXC1ZmMpatF05PJ", {
                method: "GET",
                headers: {
                    "Authorization": "Bearer " + auth_code
                    }
            }).then(response => {
                    if (!response.ok) {
                        throw new Error("Network response was not ok");
                    }
                    return response.json();
            }).then(data => {
                    
                    //keys = external_urls, followers, genres, href, id, images, name, popularity, type, uri   
                    console.log(data);
                    document.getElementById("Artist").innerText = data['name'];
                    document.getElementById("Genre").innerText = data['genres'];
                    text = "";
                    for (const i in data['followers']){
                        text += i + ", ";
                    }
                    document.getElementById("Follow").innerText = data['followers']['total'];
                    document.getElementById("image").innerHTML = "<img src=" + data['images'][2]['url'] + ">"
                    
            }).catch(error => {
                    console.error("Fetch error:", error);
            });

            

        }
    </script>
</body>
</html>